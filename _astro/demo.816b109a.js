import{r as t}from"./index.f1bc5ebf.js";/* empty css                       */import{u as w}from"./use-gesture-react.esm.e8e1245e.js";import{j as e}from"./jsx-runtime.109e40f8.js";const $={containerId:"",isRefreshAvailable:!0,threshold:20},g=s=>{const{children:u,threshold:r,containerId:l,isRefreshAvailable:h,onRefresh:i,onLoadData:j}={...$,...s},c=t.useRef(null),o=t.useRef(0);t.useRef(0);const d=t.useRef(null),y=t.useRef(0),m=t.useRef(!1),f=t.useRef(0),[R,N]=t.useState(!1),D=()=>({height:o.current<0?0:`${o.current}px`,transition:m.current?"height 0 cubic-bezier(0.25,0.1,0.25,1)":"height .2s cubic-bezier(0.25,0.1,0.25,1)"}),L=n=>l?document.querySelector(`#${l}`):n&&n.parentNode,v=t.useRef(0),I=w(async({dragging:n,movement:[H,p],offset:[P,a]})=>{const{scrollHeight:b,clientHeight:E}=c.current;if(h){const x=d.current;n?(p<f.current&&!m.current?a>0&&(x.style.height=`${p}px`):a>0&&(x.style.height=`${f.current}px`),o.current=p):(o.current>=f.current&&a>0&&i&&await i(),x.style.height="0px",o.current=0,m.current=!1)}a<0&&(Math.abs(a)<=b-E-r?(v.current=a,c.current.style.transform=`translate3d(0, ${v.current}px,0)`):!R&&!n&&(N(!0),c.current.style.transform=`translate3d(0, ${-b+E-30}px,0)`,j&&await j(),console.log("loaded data"),N(!1)))},{delay:!0});return t.useEffect(()=>{const n=L(c.current);n.style.overflow="hidden",y.current=d.current.firstElementChild.offsetHeight,f.current=y.current+10},[d.current?.firstElementChild]),e.jsxs("div",{className:"chihuoui-infiniteloading",ref:c,...I(),children:[e.jsx("div",{className:"infinite-top",style:D(),ref:d,children:e.jsx("div",{className:"top-content",children:e.jsx("span",{className:"title",children:"下拉加载"})})}),e.jsx("div",{className:"infinite-body",children:u}),e.jsx("div",{className:"infinite-bottom",children:R?e.jsx("div",{className:"bottom-content",children:e.jsx("span",{className:"title",children:"加载..."})}):e.jsx("div",{})})]})};g.defaultProps=$;g.displayName="ChihuouiInfiniteLoading";const A=()=>{const[s,u]=t.useState([]);return t.useEffect(()=>{for(let r=0;r<10;r++)s.push(`${r}`);u([...s])},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"demo",children:[e.jsx("h2",{children:"基础用法"}),e.jsx("ul",{className:"styleul",children:e.jsx(g,{onLoadData:async()=>{await new Promise((r,l)=>{setTimeout(()=>{let h=s.length;for(let i=h;i<h+10;i++)s.push(`${i}`);u([...s]),r(s)},100)})},onRefresh:()=>console.log("refresh"),children:s.map((r,l)=>e.jsx("li",{className:"styleli",children:r},l))})})]})})};export{A as default};
