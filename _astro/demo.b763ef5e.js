import{P as H}from"./pickcolumn.fe233748.js";import{c as D,_ as J}from"./_plugin-vue_export-helper.a85d8817.js";import{r as L,e as b,d as h,x as S,t as A,k as P,o as g,c as y,b as p,g as R,h as Z,i as T,F as j,z as E,l as B,j as G,n as F}from"./runtime-core.esm-bundler.23703bfe.js";/* empty css                       */const{componentName:X}=D("picker"),Y=(e,o)=>{const i=L({formattedColumns:e.columns});let t=b([]);const d=b([]),f=n=>{n&&d.value.length<s.value.length&&d.value.push(n)},v=h(()=>({[X]:!0})),u=h(()=>{let n=[];return s.value.map((a,m)=>{let l=[];l=a.filter(k=>k.value==t.value[m]),n.push(l[0])}),n}),r=h(()=>{const n=i.formattedColumns[0];if(n){if(Array.isArray(n))return"multiple";if("children"in n)return"cascade"}return"single"}),s=h(()=>{switch(r.value){case"multiple":return i.formattedColumns;case"cascade":return _(i.formattedColumns,t.value?t.value:[]);default:return[i.formattedColumns]}}),_=(n,a)=>{const m=[];let l={text:"",value:"",children:n},k=0;for(;l&&l.children;){const $=l.children,O=a[k];console.log(O,"default val");let N=$.findIndex(z=>z.value==O);N==-1&&(N=0),l=l.children[N],k++,m.push($)}return console.log(m,"abc"),m},C=()=>{o("cancel",{selectedValue:t.value,selectedOptions:u.value})},V=(n,a)=>{if(a&&Object.keys(a).length){if(t.value=t.value?t.value:[],r.value==="cascade"){t.value[n]=a.value?a.value:"";let m=n,l=a;for(;l&&l.children&&l.children[0];)t.value[m+1]=l.children[0].value,m++,l=l.children[0];l&&l.children&&l.children.length==0&&(t.value=t.value.slice(0,m+1))}else t.value[n]=a.hasOwnProperty("value")?a.value:"";o("change",{columnIndex:n,selectedValue:t.value,selectedOptions:u.value})}},c=()=>{t.value&&!t.value.length&&s.value.forEach(n=>{t.value.push(n[0].value)}),o("confirm",{selectedValue:t.value,selectedOptions:u.value})},w=(n,a)=>JSON.stringify(n)===JSON.stringify(a);return S(()=>e.modelValue,n=>{w(n,t.value)||(t.value=n)},{deep:!0,immediate:!0}),S(t,n=>{w(n,e.modelValue)||o("update:modelValue",n)},{deep:!0}),S(()=>e.columns,n=>{n.length&&(i.formattedColumns=n)}),{classes:v,...A(i),columnsType:r,columnsList:s,cancel:C,changeHandler:V,confirm:c,defaultValues:t,pickerColumn:d,swipeRef:f,selectedOptions:u,isSameValue:w}},{componentName:ce,create:M}=D("pick"),W=M({components:{[H.name]:H},props:{modelValue:{type:Array,default:()=>[]},title:{type:String,default:""},cancelText:{type:String,default:""},okText:{type:String,default:""},columns:{type:Array,default:()=>[]},threeDimensional:{type:Boolean,default:!0},swipeDuration:{type:[Number,String],default:1e3},showToolbar:{type:Boolean,default:!0},visibleOptionNum:{type:[Number,String],default:7},optionHeight:{type:[Number,String],default:36}},emits:["cancel","change","confirm","update:modelValue"],setup(e,{emit:o}){const{changeHandler:i,confirm:t,defaultValues:d,columnsList:f,columnsType:v,classes:u,cancel:r}=Y(e,o);console.log(f.value,"column list");const s=b([]),_=c=>{c&&s.value.length<f.value.length&&s.value.push(c)},C=h(()=>{const c={};return c.height=`${+e.visibleOptionNum*+e.optionHeight}px`,c["--lineHeight"]=`${+e.optionHeight}px`,c});return{classes:u,columnsType:v,columnsList:f,cancel:r,changeHandler:i,confirmHandler:()=>{s.value.length>0&&s.value.forEach(c=>{c.stopMomentum()}),t()},defaultValues:d,pickerColumn:s,swipeRef:_,columnStyle:C}}}),q={key:0,class:"cannonui-picker__bar"},K={class:"cannonui-picker__title"};function Q(e,o,i,t,d,f){const v=P("cannonui-pickcolumn");return g(),y("div",{class:F(e.classes)},[e.showToolbar?(g(),y("view",q,[p("view",{class:"cannonui-picker__left",onClick:o[0]||(o[0]=(...u)=>e.cancel&&e.cancel(...u))},"cancel"),p("view",K,R(e.title),1),p("view",{class:"cannonui-picker__right",onClick:o[1]||(o[1]=u=>e.confirmHandler())},"ok")])):Z("",!0),T(e.$slots,"top",{},void 0,!0),p("view",{class:"cannonui-picker__column",style:G(e.columnStyle)},[(g(!0),y(j,null,E(e.columnsList,(u,r)=>(g(),y("view",{class:"cannonui-picker__columnitem",key:r},[B(v,{ref_for:!0,ref:e.swipeRef,column:u,columnsType:e.columnsType,value:e.defaultValues&&e.defaultValues[r],threeDimensional:e.threeDimensional,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,optionHeight:e.optionHeight,onChange:s=>{e.changeHandler(r,s)}},null,8,["column","columnsType","value","threeDimensional","swipeDuration","visibleOptionNum","optionHeight","onChange"])]))),128))],4),T(e.$slots,"default",{},void 0,!0)],2)}const U=J(W,[["render",Q],["__scopeId","data-v-7ed36959"]]),x={props:{},emits:[],components:{Pick:U},setup(e){return{columns:h(()=>[{text:"nanJing",value:"NanJing"},{text:"wuXi",value:"WuXi"},{text:"zangZu",value:"ZangZu"},{text:"beiJing",value:"BeiJing"},{text:"lianYunGang",value:"LianYunGang"},{text:"zheJiang",value:"ZheJiang"},{text:"jiangSu",value:"JiangSu"}]),confirm:({selectedValue:t,selectedOptions:d})=>{console.log("confirm")}}}},I={class:"phone"},ee=p("div",{class:"phone-top"},"Pick",-1),ne={class:"phone-content"},te=p("h2",null,null,-1),le=p("div",{class:"phone-bottom"},null,-1);function oe(e,o,i,t,d,f){const v=P("Pick");return g(),y("div",I,[ee,p("div",ne,[te,B(v,{columns:t.columns,title:"123",onConfirm:t.confirm},null,8,["columns","onConfirm"])]),le])}const re=J(x,[["render",oe]]);export{re as default};
