import{R as w,r}from"./index.f1bc5ebf.js";/* empty css                       */import{c as L}from"./index.2e4736b8.js";import{j as p}from"./jsx-runtime.109e40f8.js";const wt=n=>n===window,yt=n=>{if(wt(n)){const C=n.innerHeight,m=n.innerWidth;return{height:C,width:m,bottom:C,right:m,top:0,left:0}}return n&&n.getBoundingClientRect?n.getBoundingClientRect():{top:0,left:0,right:0,bottom:0,height:0,width:0}},Z=w.createContext({}),tt={direction:"horizontal",loop:!0,autoPlay:0,initPage:0,className:"",width:typeof window=="object"?window.innerWidth:375,height:0,isCenter:!1,paginationVisible:!1,paginationColor:"#fff",duration:600,touchable:!0,isPreventDefault:!0,isStopPropagation:!0},U=5,et=w.forwardRef((n,C)=>{const m=r.useRef(null),P=r.useRef(null),a={...tt,...n},{children:y,isCenter:N,direction:z,onChange:M,className:$,pageContent:D}=a,l=r.useRef({moving:!1,autoplayTimer:null,width:0,height:0,offset:0,size:0}),[S,ot]=r.useState(0),[b,st]=r.useState(0);let[h,I]=r.useState(0);const[E,rt]=r.useState(null),[B,V]=r.useState(0),[_,W]=r.useState(!1),[e,Ct]=r.useState({startX:0,startY:0,deltaX:0,deltaY:0,offsetX:0,offsetY:0,stateDirection:"",delta:0,touchTime:0}),[X,at]=r.useState([]),f=a.direction==="vertical",ct=L({"chihuoui-swiper__inner":!0,__vertical:f});let d=f?S:b;const{childs:H,childCount:o}=r.useMemo(()=>{let t=0;return{childs:w.Children.map(n.children,s=>w.isValidElement(s)?(t++,s):null),childCount:t}},[n.children]),ut={propSwiper:a,size:d};let j=o*Number(d);const lt=(t=+a.initPage)=>{const i=yt(m?.current),s=Math.max(Math.min(o-1,t),0),c=a.width?a.width:i.width,u=a.height?a.height:i.height;d=f?S:b,j=o*Number(d);const v=K(s);l.current.moving=!0,_&&(l.current.moving=!1),rt(i),I(s),st(c),ot(u),V(v),W(!0)};r.useEffect(()=>{l.current.activePagination=(h+o)%o},[h]),r.useEffect(()=>{_&&F()},[f,b,S,B,_]),r.useEffect(()=>(_&&(x(),T()),()=>{W(!1)}),[_]),r.useEffect(()=>{x(),T()},[y]),r.useEffect(()=>{lt()},[a.initPage]),r.useEffect(()=>{const t=m.current;return t.addEventListener("touchstart",k,!1),t.addEventListener("touchmove",G,!1),t.addEventListener("touchend",J,!1),()=>{t.removeEventListener("touchstart",k,!1),t.removeEventListener("touchmove",G,!1),t.removeEventListener("touchend",J,!1)}}),r.useEffect(()=>()=>{x()},[]),w.useImperativeHandle(C,()=>({to:pt,next:Q,prev:vt}));const ft=t=>{const i={},s=a.direction||z,c=d;c&&(i[s==="horizontal"?"width":"height"]=`${c}px`);const u=X[t];return u&&(i.transform=`translate3D${s==="horizontal"?`(
        ${u}px,0,0
      )`:`(0,${u}px,0)`}`),i},F=(t=B)=>{const i=P.current;let s=0;if(!N)s=t;else{const c=f?S:b,u=f?E.height-c:E.width-c;s=t+(h===o-1&&!n.loop?-u/2:u/2)}i.style.transform=`translate3D${f?`(0,${s}px,0)`:`(${s}px,0,0)`}`,i.style.transitionDuration=`${l.current.moving?0:n.duration}ms`,i.style[f?"height":"width"]=`${Number(d)*o}px`,i.style[f?"width":"height"]=`${f?b:S}px`},Y=()=>{e.startX=0,e.startY=0,e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0,e.delta=0,e.stateDirection="",e.touchTime=0},ht=(t,i)=>t>i&&t>U?"horizontal":i>t&&i>U?"vertical":"",dt=t=>{Y(),e.startX=t.touches[0].clientX,e.startY=t.touches[0].clientY},mt=t=>{e.deltaX=t.touches[0].clientX-e.startX,e.deltaY=t.touches[0].clientY-e.startY,e.offsetX=Math.abs(e.deltaX),e.offsetY=Math.abs(e.deltaY),e.delta=f?e.deltaY:e.deltaX,e.stateDirection||(e.stateDirection=ht(e.offsetX,e.offsetY))},k=t=>{n.isPreventDefault&&t.preventDefault(),n.isStopPropagation&&t.stopPropagation(),n.touchable&&(dt(t),e.touchTime=Date.now(),x(),A())},G=t=>{n.touchable&&l.current.moving&&(mt(t),e.stateDirection===n.direction&&g({offset:e.delta}))},J=t=>{if(!n.touchable||!l.current.moving)return;const i=e.delta/(Date.now()-e.touchTime),s=Math.abs(i)>.3||Math.abs(e.delta)>+(d/2).toFixed(2);let c=0;if(l.current.moving=!1,s&&e.stateDirection===n.direction){const u=f?e.offsetY:e.offsetX;n.loop?u>0?c=e.delta>0?-1:1:c=0:c=-Math[e.delta>0?"ceil":"floor"](e.delta/d),g({pace:c,isEmit:!0})}else e.delta?g({pace:0}):F();T()},A=()=>{l.current.moving=!0,h<=-1&&g({pace:o}),h>=o&&g({pace:-o})},R=(()=>E?(f?E.height:E.width)-Number(d)*o:0)(),K=(t,i=0)=>{let s=t*Number(d);n.loop||(s=Math.min(s,-R));let c=i-s;return n.loop||(c=O(c,R,0)),c},gt=t=>{if(t){const i=h+t;return n.loop?O(i,-1,o):O(i,0,o-1)}return h},O=(t,i,s)=>Math.min(Math.max(t,i),s),g=({pace:t=0,offset:i=0,isEmit:s=!1,movingStatus:c=!1})=>{if(o<=1)return;const u=gt(t),v=K(u,i);if(n.loop){if(Array.isArray(y)&&y[0]&&v!==R){const q=v<R;X[0]=q?j:0}if(Array.isArray(y)&&y[o-1]&&v!==0){const q=v>0;X[o-1]=q?-j:0}at(X)}s&&h!==u&&n.onChange&&n.onChange((u+o)%o),h=u,I(u),V(v),F(v)},vt=()=>{A(),Y(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{l.current.moving=!1,g({pace:-1,isEmit:!0})})})},Q=()=>{A(),Y(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{l.current.moving=!1,g({pace:1,isEmit:!0})})})},pt=t=>{A(),Y(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{l.current.moving=!1;let i;n.loop&&o===t?i=h===0?0:t:i=t%o,g({pace:i-h,isEmit:!0})})})},x=()=>{clearTimeout(l.current.autoplayTimer),l.current.autoplayTimer=null},T=()=>{a.autoPlay<=0||o<=1||(x(),l.current.autoplayTimer=setTimeout(()=>{Q(),T()},Number(a.autoPlay)))};return p.jsx(Z.Provider,{value:ut,children:p.jsxs("div",{className:`chihuoui-swiper ${$}`,ref:m,children:[p.jsx("div",{className:ct,ref:P,children:w.Children.map(H,(t,i)=>p.jsx("div",{className:"item-wrapper",style:ft(i),children:t},i))}),a.paginationVisible&&!("pageContent"in a)?p.jsx("div",{className:L({"chihuoui-swiper__pagination":!0,"chihuoui-swiper__pagination-verticle":f}),children:w.Children.map(H,(t,i)=>p.jsx("i",{style:(h+o)%o===i?{backgroundColor:a.paginationColor}:void 0,className:L({"chihuoui-swiper__pagination-item":!0,active:(h+o)%o===i})},i))}):p.jsx("div",{children:D})]})})});et.defaultProps=tt;et.displayName="ChihuouiSwiper";const it={direction:"horizontal"},nt=w.forwardRef((n,C)=>{const m={...it,...n},{children:P,direction:a,size:y}=m,N=r.useContext(Z),z=()=>{const M={},$=N?.propSwiper?.direction||a,D=N?.size||y;return D&&(M[$==="horizontal"?"width":"height"]=`${D}px`),M};return p.jsx("div",{style:z(),className:"chihuoui-swiperitem",children:P})});nt.defaultProps=it;nt.displayName="ChihuouiSwiperItem";export{nt as S,et as a};
